# 快速开始

<cite>
**本文档中引用的文件**  
- [README.md](file://README.md)
- [requirements.txt](file://requirements.txt)
- [main.py](file://main.py)
- [default_config.py](file://tradingagents/default_config.py)
- [trading_graph.py](file://tradingagents/graph/trading_graph.py)
- [cli/main.py](file://cli/main.py)
</cite>

## 目录
1. [简介](#简介)
2. [安装与环境配置](#安装与环境配置)
3. [API密钥设置](#api密钥设置)
4. [CLI模式使用指南](#cli模式使用指南)
5. [Python API使用指南](#python-api使用指南)
6. [常见问题排查](#常见问题排查)
7. [优化建议](#优化建议)

## 简介
TradingAgents 是一个基于多智能体的金融交易框架，模拟真实交易公司的运作模式。该框架通过部署多个专业化的LLM驱动智能体，包括基本面分析师、情绪专家、技术分析师、交易员和风险管理团队，协同评估市场状况并做出交易决策。本指南将详细介绍如何安装、配置和使用该框架，涵盖CLI和Python API两种使用方式。

## 安装与环境配置

### 克隆项目
首先，使用git克隆项目仓库：
```bash
git clone https://github.com/TauricResearch/TradingAgents.git
cd TradingAgents
```

### 创建虚拟环境
建议使用conda创建独立的虚拟环境以避免依赖冲突：
```bash
conda create -n tradingagents python=3.13
conda activate tradingagents
```

### 安装依赖包
项目依赖项已定义在requirements.txt文件中，可通过以下命令安装：
```bash
pip install -r requirements.txt
```

**Section sources**
- [README.md](file://README.md#L30-L35)
- [requirements.txt](file://requirements.txt#L1-L27)

## API密钥设置
本框架需要两个关键的API密钥来获取数据和调用LLM服务。

### Finnhub API密钥
Finnhub提供金融数据服务，需要设置API密钥：
```bash
export FINNHUB_API_KEY=$YOUR_FINNHUB_API_KEY
```

### OpenAI API密钥
所有智能体都需要通过OpenAI API调用大语言模型，需设置相应的API密钥：
```bash
export OPENAI_API_KEY=$YOUR_OPENAI_API_KEY
```

**Section sources**
- [README.md](file://README.md#L58-L65)

## CLI模式使用指南
框架提供了交互式的命令行界面（CLI），用户可以通过直观的界面进行操作。

### 启动CLI
运行以下命令启动CLI界面：
```bash
python -m cli.main
```

### 交互式参数设置
CLI界面将引导用户完成以下参数设置：

1. **股票代码选择**：输入要分析的股票代码（默认为SPY）
2. **分析日期**：输入分析日期（格式：YYYY-MM-DD），不能为未来日期
3. **分析师选择**：选择参与分析的智能体类型，包括市场分析师、社交分析师、新闻分析师和基本面分析师
4. **研究深度**：选择研究深度级别，影响辩论轮次
5. **LLM服务提供商**：选择要使用的LLM服务（如OpenAI、Google等）
6. **思维模型选择**：分别选择用于浅层思考和深层思考的LLM模型

### 运行流程
系统将按照以下顺序执行分析流程：
1. 分析师团队 → 2. 研究团队 → 3. 交易团队 → 4. 风险管理团队 → 5. 投资组合管理团队

在运行过程中，界面会实时显示各智能体的状态、消息日志和当前报告，用户可以跟踪分析进度。

**Section sources**
- [README.md](file://README.md#L67-L80)
- [cli/main.py](file://cli/main.py#L120-L200)

## Python API使用指南
除了CLI模式，用户还可以通过Python API在自己的代码中集成TradingAgents框架。

### TradingAgentsGraph类初始化
通过导入`TradingAgentsGraph`类并创建实例来初始化框架：
```python
from tradingagents.graph.trading_graph import TradingAgentsGraph
from tradingagents.default_config import DEFAULT_CONFIG

ta = TradingAgentsGraph(debug=True, config=DEFAULT_CONFIG.copy())
```

### propagate函数调用
`propagate`函数是主要的执行方法，接受股票代码和分析日期作为参数：
```python
_, decision = ta.propagate("NVDA", "2024-05-10")
print(decision)
```

### 自定义配置
用户可以通过修改配置字典来自定义框架行为：
```python
config = DEFAULT_CONFIG.copy()
config["deep_think_llm"] = "gpt-4.1-nano"
config["quick_think_llm"] = "gpt-4.1-nano"
config["max_debate_rounds"] = 1
config["online_tools"] = True
ta = TradingAgentsGraph(debug=True, config=config)
```

### 返回值解析
`propagate`函数返回两个值：
1. **final_state**：包含完整的分析状态，包括各智能体的报告、辩论历史和最终决策
2. **decision**：经过`process_signal`函数处理后的核心交易决策，便于直接使用

**Section sources**
- [README.md](file://README.md#L100-L130)
- [main.py](file://main.py#L1-L22)
- [trading_graph.py](file://tradingagents/graph/trading_graph.py#L31-L253)

## 常见问题排查
### API密钥错误
- 确保环境变量已正确设置
- 检查API密钥是否有效且未过期
- 确认API服务提供商是否支持所选的LLM模型

### 网络连接问题
- 检查网络连接是否正常
- 确认API端点URL是否正确配置
- 如果使用代理，确保代理设置正确

### 依赖包安装问题
- 确保pip版本是最新的
- 如果遇到权限问题，尝试使用`--user`标志
- 对于特定平台问题，参考相关包的官方安装指南

**Section sources**
- [README.md](file://README.md#L58-L65)
- [trading_graph.py](file://tradingagents/graph/trading_graph.py#L50-L75)

## 优化建议
### 降低LLM调用成本
1. **使用轻量级模型**：在测试阶段推荐使用`o4-mini`和`gpt-4.1-mini`等成本较低的模型
2. **减少辩论轮次**：通过设置`max_debate_rounds`和`max_risk_discuss_rounds`为1来减少对话轮次
3. **启用缓存数据**：将`online_tools`设置为`False`以使用缓存数据而非实时调用API
4. **合理选择分析师**：根据需求选择必要的分析师类型，避免不必要的LLM调用

### 性能优化
1. **批量处理**：对于多个股票的分析，考虑批量处理以提高效率
2. **结果缓存**：利用框架内置的日志功能，避免重复分析相同日期的数据
3. **异步处理**：在自定义实现中考虑使用异步调用来提高并发性能

**Section sources**
- [README.md](file://README.md#L110-L115)
- [default_config.py](file://tradingagents/default_config.py#L1-L23)