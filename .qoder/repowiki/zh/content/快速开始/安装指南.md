# 安装指南

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [requirements.txt](file://requirements.txt)
- [pyproject.toml](file://pyproject.toml)
- [setup.py](file://setup.py)
- [default_config.py](file://tradingagents/default_config.py)
</cite>

## 目录
1. [项目克隆](#项目克隆)
2. [Python虚拟环境配置](#python虚拟环境配置)
3. [依赖包安装](#依赖包安装)
4. [配置文件说明](#配置文件说明)
5. [开发模式安装](#开发模式安装)
6. [常见问题排查](#常见问题排查)
7. [环境稳定性优化建议](#环境稳定性优化建议)

## 项目克隆

要开始使用TradingAgents框架，首先需要从GitHub仓库克隆项目源码。执行以下命令：

```bash
git clone https://github.com/TauricResearch/TradingAgents.git
cd TradingAgents
```

此操作将创建一个名为`TradingAgents`的本地目录，并下载完整的项目文件结构，包括核心代理模块、数据流组件、命令行接口和配置文件。

**Section sources**
- [README.md](file://README.md#L103-L105)

## Python虚拟环境配置

为确保项目依赖的隔离性和环境的稳定性，强烈建议使用Python虚拟环境。TradingAgents支持两种主流的虚拟环境管理方式：`conda`和`venv`。

### 使用Conda创建虚拟环境

Conda是数据科学和机器学习项目中广泛使用的包和环境管理工具。使用以下命令创建并激活虚拟环境：

```bash
conda create -n tradingagents python=3.13
conda activate tradingagents
```

该命令创建一个名为`tradingagents`的新环境，并安装Python 3.13版本，这是项目明确要求的最低Python版本。

### 使用Venv创建虚拟环境

`venv`是Python标准库中的虚拟环境模块，无需额外安装。使用以下命令创建和激活环境：

```bash
python -m venv tradingagents_env
source tradingagents_env/bin/activate  # Linux/macOS
# 或者在Windows上使用
# tradingagents_env\Scripts\activate
```

**Section sources**
- [README.md](file://README.md#L105-L110)

## 依赖包安装

项目依赖通过`requirements.txt`文件进行管理。在激活虚拟环境后，使用pip安装所有必需的依赖包：

```bash
pip install -r requirements.txt
```

此命令将读取`requirements.txt`文件并安装列表中的所有Python包及其指定版本。

**Section sources**
- [README.md](file://README.md#L112-L114)
- [requirements.txt](file://requirements.txt)

## 配置文件说明

项目中存在多个配置文件，它们在依赖管理和项目设置中扮演不同角色。

### requirements.txt

`requirements.txt`是一个纯文本文件，列出了项目运行所需的所有Python包及其精确版本号。它主要用于通过`pip install -r requirements.txt`命令快速安装依赖。该文件中的包列表是项目稳定运行的基础。

### pyproject.toml

`pyproject.toml`是现代Python项目的标准配置文件，遵循PEP 518规范。它不仅定义了项目元数据（如名称、版本），还通过`[project]`部分的`dependencies`字段声明了项目依赖。此文件中的依赖列表与`requirements.txt`高度一致，提供了另一种依赖管理方式。

```toml
[project]
name = "tradingagents"
version = "0.1.0"
requires-python = ">=3.10"
dependencies = [
    "akshare>=1.16.98",
    "backtrader>=1.9.78.123",
    # ... 其他依赖
]
```

### Python版本要求

根据`pyproject.toml`和`setup.py`文件中的`requires-python`字段，项目要求Python版本不低于3.10。然而，`README.md`中的安装示例明确指定了`python=3.13`，表明项目在Python 3.13环境下经过了充分测试，推荐使用此版本以确保最佳兼容性。

**Section sources**
- [pyproject.toml](file://pyproject.toml#L4-L34)
- [requirements.txt](file://requirements.txt)
- [README.md](file://README.md#L105)

## 开发模式安装

对于希望修改源码或贡献代码的开发者，应使用`setup.py`进行开发模式安装。这会将项目以可编辑的方式安装到Python环境中，使得对本地代码的修改能立即生效，而无需重新安装。

执行以下命令：

```bash
pip install -e .
```

此命令会查找当前目录下的`setup.py`文件，并以开发模式（`-e`标志）安装`tradingagents`包。`setup.py`文件中定义了包的元信息、依赖列表（`install_requires`）和命令行入口点。

```python
setup(
    name="tradingagents",
    version="0.1.0",
    packages=find_packages(),
    install_requires=[
        "langchain>=0.1.0",
        "langchain-openai>=0.0.2",
        # ... 其他依赖
    ],
    python_requires=">=3.10",
    entry_points={
        "console_scripts": [
            "tradingagents=cli.main:app",
        ],
    },
)
```

安装成功后，即可通过`tradingagents`命令直接调用CLI。

**Section sources**
- [setup.py](file://setup.py)
- [README.md](file://README.md#L112)

## 常见问题排查

### 依赖冲突

在安装过程中，可能会因不同包对同一依赖有不同版本要求而产生冲突。解决方法：
1. 确保使用全新的虚拟环境，避免旧环境残留包的影响。
2. 使用`pip check`命令检查已安装包的兼容性。
3. 若冲突持续存在，可尝试根据`pyproject.toml`中的版本约束手动安装关键包。

### Python版本兼容性

项目要求Python 3.10或更高版本，但强烈推荐使用Python 3.13。如果使用较低版本（如3.10或3.11），可能会遇到某些依赖包（特别是较新的AI/ML库）的兼容性问题。请通过`python --version`确认版本，并在必要时升级Python解释器。

### API密钥缺失

项目需要`FINNHUB_API_KEY`和`OPENAI_API_KEY`环境变量。若未设置，程序在运行时会因认证失败而报错。请按照`README.md`中的说明，通过`export`命令设置这些环境变量。

**Section sources**
- [README.md](file://README.md#L116-L123)
- [pyproject.toml](file://pyproject.toml#L4)
- [setup.py](file://setup.py#L28)

## 环境稳定性优化建议

1. **始终使用虚拟环境**：避免全局Python环境被污染，确保项目依赖的纯净。
2. **优先使用`pyproject.toml`**：作为现代Python标准，它比`requirements.txt`更具可维护性。
3. **定期更新依赖**：使用`pip list --outdated`检查过时包，并谨慎更新以平衡新功能与稳定性。
4. **冻结生产环境依赖**：在部署时，使用`pip freeze > requirements.txt`生成精确的依赖快照，确保生产环境一致性。
5. **验证安装**：安装完成后，可通过运行`python -c "import tradingagents"`来快速验证包是否正确安装。